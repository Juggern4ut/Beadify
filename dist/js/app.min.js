var canvas_source=document.getElementById("canvas_source"),context_source=canvas_source.getContext("2d"),canvas_result=document.getElementById("canvas_result"),context_result=canvas_result.getContext("2d"),colorArray=[];document.getElementById("form").addEventListener("submit",function(e){e.preventDefault(),drawResult()});var redrawSelectedColors=function o(){var i=document.getElementById("color-drawer");i.innerHTML="",colorArray.forEach(function(e,t){var n=document.createElement("div");n.addEventListener("click",function(){colorArray.splice(t,1),o()}),n.style.backgroundColor="hsl(".concat(e.hsl.hue,", ").concat(e.hsl.saturation,"%, ").concat(e.hsl.lightness,"%)"),i.append(n)})};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}window.onload=function(){var t=new ColorPicker,n=new Lightbox({draggable:!0}).setTitle("Colorpicker"),e=document.getElementById("canvas_colorpicker"),o=document.createElement("button");o.innerHTML="Add color",o.style.display="block",o.addEventListener("click",function(e){colorArray.push((new Color).setHslValue(t.currentColor.hue,t.currentColor.saturation,t.currentColor.lightness)),redrawSelectedColors()}),n.setContent([e,o]),document.getElementById("color-button").addEventListener("click",function(e){n.open()});var i=new Lightbox({additionalClasses:["align-right"],openAnimation:"buildup",closeAnimation:"collapse",draggable:!0}).setTitle("Color compare methods").setContent("\n      <h2>What are color compare methods?</h2>\n      <p>\n        Colors can be defined by several values. One is RGB which defines\n        the value for red, green and blue with a value between 0 and 255 \n        where 0 is no amount of that color and 255 is all the value of \n        that color. rgb(255, 255, 0) for example would be a mix of all \n        red and all green with no blue, so it would result in a bright \n        yellow.\n      </p>\n      <p>Another way is hsl which stands for hue, saturation and lightness.</p>\n      <p>\n        Since there are several ways to look at color, there are also\n        more than one distinct way to compare colors to oneanother.\n        And with this tool you can experiment with three of them\n      </p>\n      <ul>\n        <li>RGB - Will compare the colors by the squared average of all color values added. This one will usually provide the best results for this task</li>\n        <li>Hue - Will compare by the hue of the color. Saturation and lightness however will not be taken into consideration here.</li>\n        <li>HSL - The same as Hue but will also take saturation and lightness into effect</li>\n      </ul>\n      <p>Feel free to experiment with different color combinations and compare methods</p>\n      ");document.getElementById("info_handler").onclick=function(){i.open()}};var Color=function(){function s(){_classCallCheck(this,s),this.rgb={red:0,green:0,blue:0},this.hsl={hue:0,saturation:0,lightness:0},this.hex="#000000"}return _createClass(s,[{key:"setRgbValue",value:function(e,t,n){if(e<0||255<e)return console.warn("Red is out of bounds."),!1;if(t<0||255<t)return console.warn("Green is out of bounds."),!1;if(n<0||255<n)return console.warn("Blue is out of bounds."),!1;this.rgb.red=e,this.rgb.green=t,this.rgb.blue=n;var o=s.rgb2Hsl(e,t,n);this.hsl=o;var i=s.rgbToHex(e,t,n);return i&&(this.hex=i),this}},{key:"setHslValue",value:function(e,t,n){if(360<e||e<0)return console.warn("The hue cannot be larger than 360 or negative. It was ".concat(e)),!1;if(360<t||t<0)return console.warn("The saturation cannot be larger than 100 or negative. It was ".concat(t)),!1;if(360<n||n<0)return console.warn("The lightness  cannot be larger than 100 or negative. It was ".concat(n)),!1;this.hsl.hue=e,this.hsl.saturation=t,this.hsl.lightness=n;var o=s.hsl2rgb(e,t,n);this.rgb=o;var i=s.rgbToHex(o.red,o.green,o.blue);return i&&(this.hex=i),this}},{key:"setHexValue",value:function(e){if(!/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.test(e))return console.warn("".concat(e," is not a correct hex-value")),!1;this.hex=e;var t=s.hexToRgb(e);if(t){this.rgb=t;var n=s.rgb2Hsl(t.red,t.green,t.blue);this.hsl=n}return this}},{key:"invert",value:function(){var e=255-this.rgb.red,t=255-this.rgb.green,n=255-this.rgb.blue;return this.setRgbValue(e,t,n),this}}],[{key:"rgb2Hsl",value:function(e,t,n){e/=255,t/=255,n/=255;var o,i,s=Math.max(e,t,n),r=Math.min(e,t,n),a=(s+r)/2;if(s==r)i=o=0;else{var l=s-r;switch(i=.5<a?l/(2-s-r):l/(s+r),s){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4}o/=6}return{hue:360*o,saturation:100*i,lightness:100*a}}},{key:"hsl2rgb",value:function(o,e,i){i/=100;function t(e,t){var n=1<arguments.length&&void 0!==t?t:(e+o/30)%12;return i-s*Math.max(Math.min(n-3,9-n,1),-1)}var s=(e/=100)*Math.min(i,1-i);return{red:Math.floor(255*t(0)),green:Math.floor(255*t(8)),blue:Math.floor(255*t(4))}}},{key:"hexToRgb",value:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16)}:(console.warn("".concat(e," is not a valid hex-value so it cannot be converted")),!1)}},{key:"rgbToHex",value:function(e,t,n){(255<e||255<t||255<n||e<0||t<0||n<0)&&console.warn("Either the red, green or blue value is out of bounds. It has to be between 0 and 255");var o=e.toString(16),i=t.toString(16),s=n.toString(16);return o=1==o.length?"0"+o:o,i=1==i.length?"0"+i:i,s=1==s.length?"0"+s:s,"#".concat(o).concat(i).concat(s)}},{key:"getColorClosestByRgb",value:function(t,e){var n,o=e.map(function(e){return s.colorDiffByRgb(e,t)}),i=1e3;return o.map(function(e,t){n=e<i?t:n,i=e<i?e:i}),e[n]}},{key:"getColorClosestByHue",value:function(t,e){var n,o=e.map(function(e){return s.getHueDistance(e.hsl.hue,t.hsl.hue)}),i=1e3;return o.map(function(e,t){n=e<i?t:n,i=e<i?e:i}),e[n]}},{key:"getColorClosestByHsl",value:function(t,e){var n,o=e.map(function(e){return Math.abs(s.colorNum(e)-s.colorNum(t))+s.getHueDistance(e.hsl.hue,t.hsl.hue)}),i=1e3;return o.map(function(e,t){n=e<i?t:n,i=e<i?e:i}),e[n]}},{key:"colorDiffByRgb",value:function(e,t){return Math.sqrt((e.rgb.red-t.rgb.red)*(e.rgb.red-t.rgb.red)+(e.rgb.green-t.rgb.green)*(e.rgb.green-t.rgb.green)+(e.rgb.blue-t.rgb.blue)*(e.rgb.blue-t.rgb.blue))}},{key:"getHueDistance",value:function(e,t){return d=Math.abs(e-t),180<d?360-d:d}},{key:"colorNum",value:function(e){return 1*e.hsl.saturation+1*e.hsl.lightness}}]),s}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ColorPicker=function e(){var f=this;_classCallCheck(this,e),this.canvas=document.getElementById("canvas_colorpicker"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.offsetWidth,this.canvasHeight=this.canvas.offsetHeight,this.scaleX=this.canvasWidth/360,this.scaleY=this.canvasHeight/100,this.currentColor=null;for(var t=0,n=0,o=0,i=100,s=0;s<100;s++){for(var r=0;r<360;r++)this.ctx.fillStyle="hsl(".concat(o,", ").concat(100,"%, ").concat(i,"%)"),this.ctx.fillRect(t,n,Math.ceil(this.scaleX+1),Math.ceil(this.scaleY+1)),t+=this.scaleX,o=r;--i,t=0,n+=1}this.canvas.addEventListener("mousedown",function(e){f.selecting=!0,f.circle=document.createElement("div"),f.circle.style.cssText="background-color: red; border-radius: 50%; width: 10px; height: 10px; position: fixed; top: 0; left: 0; transform: translate(-50%, -50%); border: 1px solid #000;",f.canvas.after(f.circle)}),document.addEventListener("mouseup",function(){if(!f.selecting)return!1;f.selecting=!1,f.circle.remove()}),document.addEventListener("mousemove",function(e){if(!f.selecting)return!1;var t=f.canvas.getBoundingClientRect(),n=f.canvas.ownerDocument.defaultView,o=e.pageX-t.left+n.pageXOffset,i=e.pageY-t.top+n.pageYOffset;o=o<0?0:o,i=i<0?0:i;var s=t.top+n.pageYOffset,r=t.top+n.pageYOffset+f.canvas.offsetHeight,a=t.left+n.pageXOffset,l=t.left+n.pageXOffset+f.canvas.offsetWidth,c=e.pageY,h=e.pageX;e.pageY<s?c=s:e.pageY>r&&(c=r),e.pageX<a?h=a:e.pageX>l&&(h=l),f.circle.style.top=c+"px",f.circle.style.left=h+"px",o=o>f.canvasWidth?f.canvasWidth:o,i=i>f.canvasHeight?f.canvasHeight:i,mousePercentageX=o/f.canvasWidth,mousePercentageY=i/f.canvasHeight;var u=Math.round(360*mousePercentageX),d=Math.round(100-100*mousePercentageY);document.querySelector(".lightbox__data").style.backgroundColor="hsl(".concat(u,", 100%, ").concat(d,"%)"),f.currentColor={hue:u,saturation:100,lightness:d},f.circle.style.backgroundColor="hsl(".concat(u,", 100%, ").concat(d,"%)")})},drawBead=function(e,t,n,o,i){var s=o/2;e.beginPath(),e.arc(t+s,n+s,s-3.5,0,2*Math.PI),e.lineWidth=7,e.strokeStyle=i,e.stroke()},drawCircle=function(e,t,n,o,i){var s=o/2;e.beginPath(),e.arc(t+s,n+s,s,0,2*Math.PI),e.fillStyle=i,e.fill()},drawTriangle=function(e,t,n,o,i){var s=o/2;e.beginPath(),e.moveTo(t+s,n),e.lineTo(t+o,n+o),e.lineTo(t,n+o),e.closePath(),e.fillStyle=i,e.fill()},drawDiamond=function(e,t,n,o,i){var s=o/2;e.beginPath(),e.moveTo(t+s,n),e.lineTo(t+o,n+s),e.lineTo(t+s,n+o),e.lineTo(t,n+s),e.closePath(),e.fillStyle=i,e.fill()},drawSquare=function(e,t,n,o,i){e.fillStyle=i,e.fillRect(t,n,o,o)},drawResult=function(){var e=parseInt(document.getElementById("element_size").value);if("number"==typeof e&&2<e){var t,n=document.getElementById("fileChooser").files;if(n.length){var o=n[0];t=window.URL.createObjectURL(o)}else t="../res/sample.jpg";var i=new Image;i.src=t,context_source.clearRect(0,0,canvas_width,canvas_height),i.addEventListener("load",function(){canvas_height=i.naturalHeight,canvas_width=i.naturalWidth,canvas_source.setAttribute("height",canvas_height),canvas_source.setAttribute("width",canvas_width),canvas_result.setAttribute("height",canvas_height),canvas_result.setAttribute("width",canvas_width),context_source.drawImage(i,0,0),generateDrawing(e)})}else alert("Please enter a valid number larger than 2")},generateDrawing=function(e){var t=document.getElementById("compare_type").value;console.log(t),context_result.clearRect(0,0,canvas_width,canvas_height);for(var n=Math.floor(canvas_width/e),o=Math.floor(canvas_height/e),i=0,s=0,r=0;r<o;r++){for(var a=0;a<n;a++){var l=context_source.getImageData(i,s,e,e).data,c=getAverageColor(l),h=(new Color).setRgbValue(c.red,c.green,c.blue),u=void 0;u="hsl"===t?Color.getColorClosestByHsl(h,colorArray):"hue"===t?Color.getColorClosestByHue(h,colorArray):Color.getColorClosestByRgb(h,colorArray);var d="hsl(".concat(u.hsl.hue,", ").concat(u.hsl.saturation,"%, ").concat(u.hsl.lightness,"%)");drawCircle(context_result,i,s,e,d),i+=e}i=0,s+=e}};document.getElementById("fileChooser").addEventListener("change",function(e){var t=document.getElementById("fileChooser").files[0].name;t&&(document.querySelector(".form__label").innerHTML=t)});var getAverageColor=function(e){for(var t=0,n={red:0,green:0,blue:0,alpha:0},o=0;o<e.length;o++)o%4==0?n.red+=e[o]:o%4==1?n.green+=e[o]:o%4==2?n.blue+=e[o]:o%4==3&&(n.alpha+=e[o],t++);return{red:n.red/t,green:n.green/t,blue:n.blue/t,alpha:n.alpha/t}};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Lightbox=function(){function t(e){return _classCallCheck(this,t),e=e||{},this.isOpen=!1,this.setDefaultSettings(),this.updateSettings(e),this.setupDomElements(),this.setEscapeKeyToCloseLightbox(),this.draggableLightbox(),this.clickOutsideToClose(),this}return _createClass(t,[{key:"setupDomElements",value:function(){var t=this;this.container=document.createElement("div"),this.container.classList.add("lightbox"),this.container.style.animationDuration="".concat(this.options.animationDuration,"ms"),this.options.additionalClasses&&this.options.additionalClasses.length&&("string"==typeof this.options.additionalClasses?this.container.classList.add(this.options.additionalClasses):this.options.additionalClasses.forEach(function(e){t.container.classList.add(e)})),this.inner=document.createElement("div"),this.inner.classList.add("lightbox__inner"),this.inner.classList.add("lightbox__inner--".concat(this.options.openAnimation)),this.inner.style.animationDuration="".concat(this.options.animationDuration,"ms"),this.closeHandler=document.createElement("div"),this.closeHandler.classList.add("lightbox__close-handler"),this.title=document.createElement("p"),this.title.classList.add("lightbox__title"),this.options.draggable&&(this.title.style.cursor="move",this.title.style.WebkitUserSelect="none",this.title.style.MozUserSelect="none",this.title.style.msUserSelect="none",this.title.style.userSelect="none"),this.closeHandler.onclick=function(){t.close()},this.data=document.createElement("div"),this.data.classList.add("lightbox__data"),this.options.closeHandler&&this.options.closeable&&this.inner.append(this.closeHandler),this.inner.append(this.title),this.inner.append(this.data),this.container.append(this.inner),this.options.appendingElement.append(this.container)}},{key:"setEscapeKeyToCloseLightbox",value:function(){var t=this;return!(!this.options.closeByEscape||!this.options.closeable)&&(document.addEventListener("keydown",function(e){27===e.keyCode&&t.isOpen&&t.close()}),!0)}},{key:"clickOutsideToClose",value:function(){var t=this;return!(!this.options.clickOutsideToClose||!this.options.closeable)&&(this.container.addEventListener("click",function(e){e.target===t.container&&t.close()}),!0)}},{key:"draggableLightbox",value:function(){var i=this;if(!this.options.draggable)return!1;this.isDragging=!1,this.currentTop=0,this.currentLeft=0;function t(e){i.isDragging=!0,i.initialDragX="touchmove"===e.type?e.touches[0].pageX:e.pageX,i.initialDragY="touchmove"===e.type?e.touches[0].pageY:e.pageY}function n(e){if(!i.isDragging)return!1;e.preventDefault();var t="touchmove"===e.type?e.touches[0].pageX:e.pageX,n=("touchmove"===e.type?e.touches[0].pageY:e.pageY)-i.initialDragY+i.currentTop,o=t-i.initialDragX+i.currentLeft;i.inner.style.top="".concat(n,"px"),i.inner.style.left="".concat(o,"px")}function o(){if(!i.isDragging)return!1;i.isDragging=!1,i.currentTop=parseInt(i.inner.style.top),i.currentLeft=parseInt(i.inner.style.left),i.currentTop=i.currentTop?i.currentTop:0,i.currentLeft=i.currentLeft?i.currentLeft:0,i.options.keepInBounds&&i.keepInBounds(i.options.boundsOffset)}return this.title.addEventListener("mousedown",function(e){return t(e)}),this.title.addEventListener("touchstart",function(e){return t(e)},!1),document.querySelector("body").addEventListener("mousemove",function(e){return n(e)}),document.querySelector("body").addEventListener("touchmove",function(e){return n(e)}),document.querySelector("body").addEventListener("mouseup",function(e){return o()}),document.querySelector("body").addEventListener("touchend",function(e){return o()}),!0}},{key:"resetPosition",value:function(){return!!this.options.draggable&&(this.inner.style.top=0,this.inner.style.left=0,this.currentLeft=0,!(this.currentTop=0))}},{key:"keepInBounds",value:function(e){var t={wentAbove:!1,wentBelow:!1,wentLeft:!1,wentRight:!1};if(this.inner.offsetTop<0){var n=this.currentTop+Math.abs(this.inner.offsetTop)+e;this.inner.style.top="".concat(n,"px"),this.currentTop=n,t.wentAbove=!0}else if(this.inner.offsetTop+this.inner.offsetHeight>window.innerHeight){var o=this.inner.offsetTop+this.inner.offsetHeight+e,i=window.innerHeight-o,s=this.currentTop+i;this.inner.style.top="".concat(s,"px"),this.currentTop=s;var r=-1*(parseInt(window.getComputedStyle(this.inner,null).getPropertyValue("margin-top"))-e);this.currentTop<r&&(this.currentTop=r,this.inner.style.top="".concat(r,"px")),t.wentBelow=!0}if(this.inner.offsetLeft<0){var a=this.currentLeft+Math.abs(this.inner.offsetLeft)+e;this.inner.style.left="".concat(a,"px"),this.currentLeft=a,t.wentLeft=!0}else if(this.inner.offsetLeft+this.inner.offsetWidth>window.innerWidth){var l=this.inner.offsetLeft+this.inner.offsetWidth+e,c=window.innerWidth-l,h=this.currentLeft+c;this.inner.style.left="".concat(h,"px"),this.currentLeft=h;var u=-1*(parseInt(window.getComputedStyle(this.inner,null).getPropertyValue("margin-left"))-e);this.currentLeft<u&&(this.currentLeft=u,this.inner.style.left="".concat(u,"px")),t.wentRight=!0}return t}},{key:"setDefaultSettings",value:function(){this.options={},this.options.additionalClasses=[],this.options.closeable=!0,this.options.draggable=!1,this.options.closeHandler=!0,this.options.closeByEscape=!0,this.options.openAnimation="fadedown",this.options.closeAnimation="fadeup",this.options.clickOutsideToClose=!0,this.options.animationDuration=500,this.options.boundsOffset=20,this.options.keepInBounds=!0,this.options.appendingElement=document.querySelector("body"),this.options.open=function(){},this.options.opened=function(){},this.options.close=function(){},this.options.closed=function(){},this.options.destroyed=function(){}}},{key:"updateSettings",value:function(e){for(var t in e)if("appendingElement"!==t||e.appendingElement||console.warn("The Element to append the lightbox to, could not be found. It will be appended to the body instead."),e.hasOwnProperty(t))if("object"===_typeof(e[t]))if(e[t]instanceof Element||e[t]instanceof HTMLDocument)this.options[t]=e[t];else{var n=e[t];for(var o in n)n.hasOwnProperty(o)&&(this.options[t][o]=n[o])}else this.options[t]=e[t]}},{key:"setContent",value:function(e){var t=this;return this.data.innerHTML="","object"===_typeof(e)?e.length?e.forEach(function(e){"string"==typeof e?t.data.innerHTML+=e:t.data.append(e)}):this.data.append(e):this.data.innerHTML=e,this}},{key:"setTitle",value:function(e){return e=e||"",this.title.innerHTML=e,this}},{key:"open",value:function(){var e=this;return this.options.open(),this.resetPosition(),this.container.classList.add("lightbox--open"),this.container.classList.add("lightbox--opening"),document.querySelector("body, html").style.overflow="hidden",setTimeout(function(){e.container.classList.remove("lightbox--opening"),e.isOpen=!0,e.options.opened()},this.options.animationDuration),this}},{key:"close",value:function(){var e=this;return this.options.close(),this.inner.classList.add("lightbox__inner--".concat(this.options.closeAnimation)),this.container.classList.add("lightbox--closing"),setTimeout(function(){e.container.classList.remove("lightbox--open"),e.container.classList.remove("lightbox--closing"),e.isOpen=!1,document.querySelector("body, html").style.overflow="auto",e.inner.classList.remove("lightbox__inner--".concat(e.options.closeAnimation)),e.options.closed()},this.options.animationDuration),this}},{key:"destroy",value:function(){this.container.remove(),this.inner.remove(),this.closeHandler.remove(),this.title.remove(),this.data.remove(),this.options.destroyed()}}]),t}(),drawing=new Image,canvas_width=0,canvas_height=0;drawing.src="../../res/sample.jpg",drawing.addEventListener("load",function(){canvas_height=drawing.naturalHeight,canvas_width=drawing.naturalWidth,canvas_source.setAttribute("height",canvas_height),canvas_source.setAttribute("width",canvas_width),canvas_result.setAttribute("height",canvas_height),canvas_result.setAttribute("width",canvas_width),context_source.drawImage(drawing,0,0);for(var e=0;e<10;e++)colorArray.push((new Color).setHslValue(0,0,10*e));redrawSelectedColors(),generateDrawing(20)});var size_slider=document.getElementById("size_slider");size_slider.oninput=function(){document.getElementById("element_size").value=size_slider.value},size_slider.addEventListener("change",function(){drawResult()});
//# sourceMappingURL=../maps/app.min.js.map
